@using BlazorFrontend.Services
@inject ThemeService ThemeService
@inject IJSRuntime JSRuntime

<div class="theme-toggle">
    <button class="btn btn-outline-secondary theme-btn" @onclick="ToggleTheme" title="Toggle theme">
        @if (currentTheme == "dark")
        {
            <span class="oi oi-sun" aria-hidden="true"></span>
            <span class="theme-text">Light</span>
        }
        else
        {
            <span class="oi oi-moon" aria-hidden="true"></span>
            <span class="theme-text">Dark</span>
        }
    </button>
</div>

@code {
    private string currentTheme = "light";

    protected override async Task OnInitializedAsync()
    {
        currentTheme = await ThemeService.GetCurrentThemeAsync();
        ThemeService.OnThemeChanged += async () =>
        {
            currentTheme = await ThemeService.GetCurrentThemeAsync();
            StateHasChanged();
        };
    }

    private async Task ToggleTheme()
    {
        await ThemeService.ToggleThemeAsync();
    }
}
